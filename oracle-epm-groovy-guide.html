<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Comprehensive Oracle EPM Cloud Groovy Scripting Study Guide covering Planning (EPBCS), FCCS, and PCMCS from beginner to advanced">
    <title>Oracle EPM Cloud Groovy Scripting | Complete Study Guide</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=Fraunces:opsz,wght@9..144,400;9..144,600;9..144,700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #FAFAFA;
            --bg-secondary: #FFFFFF;
            --bg-tertiary: #F4F4F5;
            --bg-code: #18181B;
            --text-primary: #18181B;
            --text-secondary: #52525B;
            --text-tertiary: #71717A;
            --text-code: #E4E4E7;
            --accent-primary: #7C3AED;
            --accent-secondary: #A78BFA;
            --accent-tertiary: #EDE9FE;
            --border-color: #E4E4E7;
            --border-light: #F4F4F5;
            --success: #10B981;
            --warning: #F59E0B;
            --error: #EF4444;
            --font-display: 'Fraunces', Georgia, serif;
            --font-body: 'Plus Jakarta Sans', -apple-system, sans-serif;
            --font-mono: 'JetBrains Mono', 'Fira Code', monospace;
            --sidebar-width: 280px;
            --content-max-width: 900px;
            --header-height: 64px;
        }
        [data-theme="dark"] {
            --bg-primary: #09090B;
            --bg-secondary: #18181B;
            --bg-tertiary: #27272A;
            --bg-code: #0C0C0E;
            --text-primary: #FAFAFA;
            --text-secondary: #A1A1AA;
            --text-tertiary: #71717A;
            --accent-tertiary: #2E1065;
            --border-color: #27272A;
            --border-light: #3F3F46;
        }
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; scroll-padding-top: calc(var(--header-height) + 2rem); }
        body { font-family: var(--font-body); font-size: 16px; line-height: 1.7; color: var(--text-primary); background: var(--bg-primary); transition: background 0.3s ease, color 0.3s ease; }
        .header { position: fixed; top: 0; left: 0; right: 0; height: var(--header-height); background: var(--bg-secondary); border-bottom: 1px solid var(--border-color); z-index: 1000; display: flex; align-items: center; justify-content: space-between; padding: 0 2rem; backdrop-filter: blur(10px); }
        .header-brand { display: flex; align-items: center; gap: 1rem; }
        .header-logo { width: 40px; height: 40px; background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-family: var(--font-mono); font-weight: 700; font-size: 18px; color: white; }
        .header-title { font-family: var(--font-display); font-size: 1.25rem; font-weight: 600; }
        .header-subtitle { font-size: 0.75rem; color: var(--text-tertiary); text-transform: uppercase; letter-spacing: 0.5px; }
        .header-actions { display: flex; align-items: center; gap: 1rem; }
        .btn { display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1rem; border-radius: 8px; font-size: 0.875rem; font-weight: 500; cursor: pointer; transition: all 0.2s ease; border: 1px solid var(--border-color); background: var(--bg-secondary); color: var(--text-primary); }
        .btn:hover { background: var(--bg-tertiary); border-color: var(--accent-primary); }
        .btn-icon { width: 36px; height: 36px; padding: 0; justify-content: center; }
        .menu-toggle { display: none; }
        .layout { display: flex; min-height: 100vh; padding-top: var(--header-height); }
        .sidebar { position: fixed; top: var(--header-height); left: 0; width: var(--sidebar-width); height: calc(100vh - var(--header-height)); background: var(--bg-secondary); border-right: 1px solid var(--border-color); overflow-y: auto; padding: 1.5rem; z-index: 100; transition: transform 0.3s ease; }
        .sidebar-section { margin-bottom: 1.5rem; }
        .sidebar-title { font-size: 0.7rem; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; color: var(--text-tertiary); margin-bottom: 0.5rem; padding-left: 0.5rem; }
        .nav-list { list-style: none; }
        .nav-item { margin-bottom: 2px; }
        .nav-link { display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1rem; color: var(--text-secondary); text-decoration: none; font-size: 0.875rem; border-radius: 6px; transition: all 0.15s ease; }
        .nav-link:hover { background: var(--bg-tertiary); color: var(--text-primary); }
        .nav-link.active { background: var(--accent-tertiary); color: var(--accent-primary); font-weight: 600; }
        .main { flex: 1; margin-left: var(--sidebar-width); padding: 3rem 2rem; max-width: calc(var(--content-max-width) + var(--sidebar-width) + 4rem); }
        .content { max-width: var(--content-max-width); }
        h1, h2, h3, h4, h5, h6 { font-family: var(--font-display); font-weight: 600; line-height: 1.3; color: var(--text-primary); }
        h1 { font-size: 2.5rem; font-weight: 700; margin-bottom: 1.5rem; background: linear-gradient(135deg, var(--text-primary), var(--accent-primary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        h2 { font-size: 1.75rem; margin-top: 4rem; margin-bottom: 1.5rem; padding-bottom: 0.5rem; border-bottom: 2px solid var(--border-color); }
        h3 { font-size: 1.375rem; margin-top: 3rem; margin-bottom: 1rem; color: var(--accent-primary); }
        h4 { font-size: 1.125rem; margin-top: 2rem; margin-bottom: 0.5rem; }
        p { margin-bottom: 1rem; color: var(--text-secondary); }
        strong { color: var(--text-primary); font-weight: 600; }
        a { color: var(--accent-primary); text-decoration: none; transition: color 0.2s ease; }
        a:hover { color: var(--accent-secondary); text-decoration: underline; }
        .hero { background: linear-gradient(135deg, var(--accent-tertiary), var(--bg-secondary)); border-radius: 16px; padding: 3rem; margin-bottom: 3rem; border: 1px solid var(--border-color); }
        .hero-badge { display: inline-flex; align-items: center; gap: 0.25rem; background: var(--accent-primary); color: white; font-size: 0.75rem; font-weight: 600; padding: 0.25rem 0.5rem; border-radius: 20px; margin-bottom: 1rem; }
        .hero-description { font-size: 1.125rem; color: var(--text-secondary); margin-bottom: 1.5rem; max-width: 700px; }
        .hero-meta { display: flex; flex-wrap: wrap; gap: 1.5rem; font-size: 0.875rem; color: var(--text-tertiary); }
        .hero-meta-item { display: flex; align-items: center; gap: 0.25rem; }
        pre { background: var(--bg-code); border-radius: 12px; padding: 1.5rem; overflow-x: auto; margin: 1rem 0 1.5rem; border: 1px solid var(--border-color); position: relative; }
        pre::before { content: attr(data-language); position: absolute; top: 0; right: 0; background: var(--accent-primary); color: white; font-size: 0.7rem; font-weight: 600; padding: 2px 10px; border-radius: 0 12px 0 8px; text-transform: uppercase; }
        code { font-family: var(--font-mono); font-size: 0.875rem; line-height: 1.6; }
        pre code { color: var(--text-code); }
        :not(pre) > code { background: var(--bg-tertiary); padding: 2px 6px; border-radius: 4px; font-size: 0.85em; color: var(--accent-primary); }
        .token-keyword { color: #C678DD; }
        .token-string { color: #98C379; }
        .token-number { color: #D19A66; }
        .token-comment { color: #5C6370; font-style: italic; }
        .token-function { color: #61AFEF; }
        .token-class { color: #E5C07B; }
        .token-operator { color: #56B6C2; }
        .token-property { color: #E06C75; }
        .token-boolean { color: #D19A66; }
        .table-wrapper { overflow-x: auto; margin: 1rem 0 1.5rem; border-radius: 12px; border: 1px solid var(--border-color); }
        table { width: 100%; border-collapse: collapse; font-size: 0.875rem; }
        th { background: var(--bg-tertiary); font-weight: 600; text-align: left; padding: 1rem; color: var(--text-primary); border-bottom: 2px solid var(--border-color); }
        td { padding: 1rem; border-bottom: 1px solid var(--border-light); color: var(--text-secondary); }
        tr:last-child td { border-bottom: none; }
        tr:hover td { background: var(--bg-tertiary); }
        .callout { padding: 1.5rem; border-radius: 12px; margin: 1.5rem 0; border-left: 4px solid; }
        .callout-info { background: rgba(124, 58, 237, 0.1); border-color: var(--accent-primary); }
        .callout-warning { background: rgba(245, 158, 11, 0.1); border-color: var(--warning); }
        .callout-success { background: rgba(16, 185, 129, 0.1); border-color: var(--success); }
        .callout-error { background: rgba(239, 68, 68, 0.1); border-color: var(--error); }
        .callout-title { font-weight: 700; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem; }
        .callout-info .callout-title { color: var(--accent-primary); }
        .callout-warning .callout-title { color: var(--warning); }
        .callout-success .callout-title { color: var(--success); }
        .callout-error .callout-title { color: var(--error); }
        .diagram { background: var(--bg-code); border-radius: 12px; padding: 1.5rem; margin: 1.5rem 0; overflow-x: auto; font-family: var(--font-mono); font-size: 0.8rem; line-height: 1.4; color: var(--text-code); border: 1px solid var(--border-color); }
        .diagram-title { font-weight: 600; color: var(--accent-secondary); margin-bottom: 1rem; font-size: 0.9rem; }
        ul, ol { margin: 1rem 0; padding-left: 2rem; color: var(--text-secondary); }
        li { margin-bottom: 0.5rem; }
        li::marker { color: var(--accent-primary); }
        .section { scroll-margin-top: calc(var(--header-height) + 2rem); }
        .card-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; margin: 1.5rem 0; }
        .card { background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 12px; padding: 1.5rem; transition: all 0.2s ease; }
        .card:hover { border-color: var(--accent-primary); box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
        .card-icon { width: 48px; height: 48px; background: var(--accent-tertiary); border-radius: 10px; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem; font-size: 24px; }
        .card-title { font-size: 1.125rem; font-weight: 600; margin-bottom: 0.5rem; }
        .card-description { font-size: 0.875rem; color: var(--text-tertiary); }
        .version-history { background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 12px; padding: 1.5rem; margin: 1.5rem 0; }
        .version-item { display: flex; gap: 1rem; padding: 1rem 0; border-bottom: 1px solid var(--border-light); }
        .version-item:last-child { border-bottom: none; padding-bottom: 0; }
        .version-badge { background: var(--accent-primary); color: white; font-size: 0.75rem; font-weight: 600; padding: 2px 8px; border-radius: 4px; height: fit-content; }
        .version-date { font-size: 0.75rem; color: var(--text-tertiary); }
        .progress-bar { position: fixed; top: var(--header-height); left: 0; right: 0; height: 3px; background: var(--border-color); z-index: 999; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary)); width: 0%; transition: width 0.1s ease; }
        .code-wrapper { position: relative; }
        .copy-btn { position: absolute; top: 8px; right: 8px; background: var(--bg-tertiary); border: none; border-radius: 6px; padding: 6px 10px; font-size: 0.75rem; color: var(--text-secondary); cursor: pointer; opacity: 0; transition: all 0.2s ease; }
        .code-wrapper:hover .copy-btn { opacity: 1; }
        .copy-btn:hover { background: var(--accent-primary); color: white; }
        .copy-btn.copied { background: var(--success); color: white; }
        .search-container { position: relative; margin-bottom: 1.5rem; }
        .search-input { width: 100%; padding: 0.5rem 1rem 0.5rem 40px; border: 1px solid var(--border-color); border-radius: 8px; background: var(--bg-tertiary); color: var(--text-primary); font-size: 0.875rem; outline: none; transition: all 0.2s ease; }
        .search-input:focus { border-color: var(--accent-primary); box-shadow: 0 0 0 3px var(--accent-tertiary); }
        .search-icon { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--text-tertiary); }
        .footer { margin-top: 4rem; padding: 2rem 0; border-top: 1px solid var(--border-color); text-align: center; color: var(--text-tertiary); font-size: 0.875rem; }
        .back-to-top { position: fixed; bottom: 24px; right: 24px; width: 44px; height: 44px; background: var(--accent-primary); color: white; border: none; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; opacity: 0; visibility: hidden; transition: all 0.3s ease; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); z-index: 100; }
        .back-to-top.visible { opacity: 1; visibility: visible; }
        .back-to-top:hover { transform: translateY(-3px); }
        @media print { .header, .sidebar, .progress-bar, .copy-btn, .btn, .back-to-top { display: none !important; } .main { margin-left: 0; padding: 0; } .layout { padding-top: 0; } pre { white-space: pre-wrap; word-wrap: break-word; } }
        @media (max-width: 1024px) { .sidebar { transform: translateX(-100%); } .sidebar.open { transform: translateX(0); } .main { margin-left: 0; } .menu-toggle { display: flex; } .overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 99; } .overlay.show { display: block; } }
        @media (max-width: 640px) { h1 { font-size: 1.75rem; } h2 { font-size: 1.375rem; } .header-title { font-size: 1rem; } .header-subtitle { display: none; } .hero { padding: 1.5rem; } .card-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
    <header class="header">
        <div class="header-brand">
            <button class="btn btn-icon menu-toggle" onclick="toggleSidebar()" aria-label="Toggle menu">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
            </button>
            <div class="header-logo">G</div>
            <div>
                <div class="header-title">Oracle EPM Groovy Guide</div>
                <div class="header-subtitle">Planning â€¢ FCCS â€¢ PCMCS</div>
            </div>
        </div>
        <div class="header-actions">
            <button class="btn btn-icon" onclick="toggleTheme()" aria-label="Toggle theme" title="Toggle dark/light mode">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" id="themeIcon"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
            </button>
            <button class="btn" onclick="window.print()" title="Print or save as PDF">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 6 2 18 2 18 9"></polyline><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path><rect x="6" y="14" width="12" height="8"></rect></svg>
                Print
            </button>
        </div>
    </header>
    <div class="overlay" id="overlay" onclick="toggleSidebar()"></div>
    <div class="layout">
        <aside class="sidebar" id="sidebar">
            <div class="search-container">
                <svg class="search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                <input type="text" class="search-input" placeholder="Search topics..." id="searchInput" onkeyup="searchContent()">
            </div>
            <nav>
                <div class="sidebar-section">
                    <div class="sidebar-title">Getting Started</div>
                    <ul class="nav-list">
                        <li class="nav-item"><a href="#introduction" class="nav-link active">Introduction</a></li>
                        <li class="nav-item"><a href="#version-history" class="nav-link">Version History</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-title">Part 1: Groovy Fundamentals</div>
                    <ul class="nav-list">
                        <li class="nav-item"><a href="#fundamentals" class="nav-link">Overview</a></li>
                        <li class="nav-item"><a href="#variables" class="nav-link">Variables & Data Types</a></li>
                        <li class="nav-item"><a href="#operators" class="nav-link">Operators</a></li>
                        <li class="nav-item"><a href="#control-structures" class="nav-link">Control Structures</a></li>
                        <li class="nav-item"><a href="#collections" class="nav-link">Collections</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-title">Part 2: EPM Environment</div>
                    <ul class="nav-list">
                        <li class="nav-item"><a href="#architecture" class="nav-link">Architecture</a></li>
                        <li class="nav-item"><a href="#script-types" class="nav-link">Script Types</a></li>
                        <li class="nav-item"><a href="#creating-rules" class="nav-link">Creating Rules</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-title">Part 3: Planning (EPBCS)</div>
                    <ul class="nav-list">
                        <li class="nav-item"><a href="#planning-overview" class="nav-link">Overview</a></li>
                        <li class="nav-item"><a href="#datagrid-definition" class="nav-link">DataGridDefinitionBuilder</a></li>
                        <li class="nav-item"><a href="#datagrid-builder" class="nav-link">DataGridBuilder</a></li>
                        <li class="nav-item"><a href="#form-grid" class="nav-link">Working with Forms</a></li>
                        <li class="nav-item"><a href="#validations" class="nav-link">Validations</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-title">Part 4: FCCS</div>
                    <ul class="nav-list">
                        <li class="nav-item"><a href="#fccs-overview" class="nav-link">Overview</a></li>
                        <li class="nav-item"><a href="#consolidation" class="nav-link">Consolidation Rules</a></li>
                        <li class="nav-item"><a href="#journals" class="nav-link">Journals</a></li>
                        <li class="nav-item"><a href="#close-process" class="nav-link">Close Automation</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-title">Part 5: PCMCS</div>
                    <ul class="nav-list">
                        <li class="nav-item"><a href="#pcmcs-overview" class="nav-link">Overview</a></li>
                        <li class="nav-item"><a href="#pcmcs-jobs" class="nav-link">Triggering Jobs</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-title">Part 6: Advanced</div>
                    <ul class="nav-list">
                        <li class="nav-item"><a href="#rest-api" class="nav-link">REST API Integration</a></li>
                        <li class="nav-item"><a href="#epm-automate" class="nav-link">EPM Automate</a></li>
                        <li class="nav-item"><a href="#performance" class="nav-link">Performance</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-title">Part 7: 2025 Updates</div>
                    <ul class="nav-list">
                        <li class="nav-item"><a href="#updates-2025" class="nav-link">Platform Updates</a></li>
                        <li class="nav-item"><a href="#groovy-upgrade" class="nav-link">Groovy Engine Upgrade</a></li>
                    </ul>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-title">Reference</div>
                    <ul class="nav-list">
                        <li class="nav-item"><a href="#diagrams" class="nav-link">Visual Diagrams</a></li>
                        <li class="nav-item"><a href="#quick-reference" class="nav-link">Quick Reference</a></li>
                        <li class="nav-item"><a href="#resources" class="nav-link">External Resources</a></li>
                    </ul>
                </div>
            </nav>
        </aside>
        <main class="main">
            <div class="content">
                <!-- Hero Section -->
                <section class="hero section" id="introduction">
                    <div class="hero-badge">ğŸ“š Complete Study Guide</div>
                    <h1>Oracle EPM Cloud Groovy Scripting</h1>
                    <p class="hero-description">From zero programming knowledge to advanced EPM Groovy proficiency. Covering Planning (EPBCS), Financial Consolidation (FCCS), and Profitability & Cost Management (PCMCS) with complete code examples, real-world use cases, and current 2024-2025 platform updates.</p>
                    <div class="hero-meta">
                        <div class="hero-meta-item">ğŸ“… Last Updated: December 2025</div>
                        <div class="hero-meta-item">â±ï¸ ~4 hours reading time</div>
                        <div class="hero-meta-item">ğŸ“„ v2.1</div>
                    </div>
                </section>

                <!-- Version History -->
                <section class="section" id="version-history">
                    <h2>Version History</h2>
                    <p>This guide is maintained and updated as Oracle releases new EPM features and API enhancements.</p>
                    <div class="version-history">
                        <div class="version-item">
                            <div><span class="version-badge">v2.1</span></div>
                            <div><strong>December 2025</strong> <span class="version-date">Current Release</span><p>Added Groovy Engine Upgrade requirements (January 2026), new ZIP and Excel file creation features, Pipeline SFTP support.</p></div>
                        </div>
                        <div class="version-item">
                            <div><span class="version-badge">v2.0</span></div>
                            <div><strong>October 2025</strong><p>Complete rewrite with expanded FCCS coverage, PCMCS orchestration patterns, and REST API integration.</p></div>
                        </div>
                        <div class="version-item">
                            <div><span class="version-badge">v1.0</span></div>
                            <div><strong>June 2025</strong><p>Initial release covering Groovy fundamentals and Planning scripting basics.</p></div>
                        </div>
                    </div>
                </section>

                <!-- Part 1: Groovy Fundamentals -->
                <section class="section" id="fundamentals">
                    <h2>Part 1: Groovy Fundamentals for EPM Beginners</h2>
                    <p>Groovy is a dynamic programming language built for the Java platform that Oracle selected for EPM Cloud because it seamlessly integrates with EPM's Java-based architecture while offering simplified syntax that business analysts can learn.</p>
                    <div class="callout callout-info">
                        <div class="callout-title">ğŸ’¡ Key Insight</div>
                        Groovy scripts in EPM can either perform operations entirely within the Groovy runtime OR return a string that executes as an Essbase calculation scriptâ€”understanding this dual nature is fundamental.
                    </div>
                </section>

                <section class="section" id="variables">
                    <h3>Variables and Data Types Essential for EPM</h3>
                    <p>Every EPM Groovy script works with data. Understanding data types prevents precision errors that plague financial calculations.</p>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <pre data-language="groovy"><code><span class="token-comment">// Dynamic typing with 'def' - most common in EPM</span>
<span class="token-keyword">def</span> memberName = <span class="token-string">"FY24"</span>
<span class="token-keyword">def</span> amount = <span class="token-number">1500.50</span>
<span class="token-keyword">def</span> isActive = <span class="token-boolean">true</span>

<span class="token-comment">// Explicit typing - recommended for clarity</span>
<span class="token-class">String</span> scenario = <span class="token-string">"Actual"</span>
<span class="token-class">BigDecimal</span> revenue = <span class="token-number">50000.00</span>
<span class="token-keyword">int</span> periodNumber = <span class="token-number">12</span></code></pre>
                    </div>
                    <div class="callout callout-error">
                        <div class="callout-title">âš ï¸ Critical: Financial Precision</div>
                        <strong>BigDecimal is mandatory for financial data.</strong> Using <code>double</code> causes precision issues that compound across calculations.
                    </div>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <pre data-language="groovy"><code><span class="token-comment">// WRONG: Double causes precision errors</span>
<span class="token-keyword">double</span> badValue = <span class="token-number">0.1</span> + <span class="token-number">0.2</span>  <span class="token-comment">// Results in 0.30000000000000004</span>

<span class="token-comment">// CORRECT: BigDecimal maintains financial precision</span>
<span class="token-class">BigDecimal</span> goodValue = <span class="token-number">0.1g</span> + <span class="token-number">0.2g</span>  <span class="token-comment">// Results in exactly 0.3</span></code></pre>
                    </div>
                </section>

                <section class="section" id="operators">
                    <h3>Operators That Matter for EPM Calculations</h3>
                    <h4>Safe Navigation Operator (<code>?.</code>)</h4>
                    <p>Prevents null pointer exceptionsâ€”critical because EPM data frequently contains nulls:</p>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <pre data-language="groovy"><code><span class="token-comment">// DANGEROUS: Crashes if cell.value is null</span>
<span class="token-keyword">def</span> cellValue = cell.value.<span class="token-function">toString</span>()

<span class="token-comment">// SAFE: Returns null gracefully</span>
<span class="token-keyword">def</span> cellValue = cell?.value?.<span class="token-function">toString</span>()</code></pre>
                    </div>
                    <h4>Elvis Operator (<code>?:</code>)</h4>
                    <p>Provides default values for null scenarios:</p>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <pre data-language="groovy"><code><span class="token-comment">// If dataValue is null, use 0 instead</span>
<span class="token-keyword">def</span> amount = dataValue <span class="token-operator">?:</span> <span class="token-number">0</span>

<span class="token-comment">// Practical EPM example: Default variance calculation</span>
<span class="token-keyword">def</span> variance = (actualValue <span class="token-operator">?:</span> <span class="token-number">0</span>) - (budgetValue <span class="token-operator">?:</span> <span class="token-number">0</span>)</code></pre>
                    </div>
                </section>

                <section class="section" id="control-structures">
                    <h3>Control Structures with EPM-Relevant Patterns</h3>
                    <h4>If/Else for Validation Logic</h4>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <pre data-language="groovy"><code><span class="token-keyword">def</span> salesValue = data.<span class="token-function">getCellValue</span>(<span class="token-string">"Revenue"</span>, <span class="token-string">"Sales"</span>)

<span class="token-keyword">if</span> (salesValue == <span class="token-keyword">null</span> || salesValue == <span class="token-number">0</span>) {
    <span class="token-function">throwVetoException</span>(<span class="token-string">"Sales Revenue cannot be empty or zero"</span>)
} <span class="token-keyword">else if</span> (salesValue < <span class="token-number">0</span>) {
    <span class="token-function">throwVetoException</span>(<span class="token-string">"Sales Revenue cannot be negative"</span>)
} <span class="token-keyword">else</span> {
    <span class="token-keyword">def</span> tax = salesValue * <span class="token-number">0.21</span>
}</code></pre>
                    </div>
                    <h4>The <code>each</code> Loop with Closures â€” The EPM Standard</h4>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <pre data-language="groovy"><code><span class="token-comment">// Iterate over data grid cells - the fundamental EPM pattern</span>
operation.grid.<span class="token-function">dataCellIterator</span>().<span class="token-function">each</span> { cell ->
    <span class="token-keyword">if</span> (cell.edited) {
        <span class="token-keyword">def</span> originalValue = cell.originalValue <span class="token-operator">?:</span> <span class="token-number">0</span>
        <span class="token-keyword">def</span> newValue = cell.data <span class="token-operator">?:</span> <span class="token-number">0</span>
        <span class="token-keyword">def</span> variance = newValue - originalValue
        
        <span class="token-keyword">if</span> (variance > <span class="token-number">1000000</span>) {
            cell.<span class="token-function">addValidationError</span>(<span class="token-string">"Large variance requires approval"</span>)
        }
    }
}</code></pre>
                    </div>
                </section>

                <section class="section" id="collections">
                    <h3>Collections: Lists and Maps for EPM Data</h3>
                    <h4>Lists for Member Sequences</h4>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <pre data-language="groovy"><code><span class="token-keyword">def</span> periods = [<span class="token-string">"Jan"</span>, <span class="token-string">"Feb"</span>, <span class="token-string">"Mar"</span>, <span class="token-string">"Apr"</span>, <span class="token-string">"May"</span>, <span class="token-string">"Jun"</span>]

<span class="token-comment">// Access elements</span>
<span class="token-function">println</span> periods[<span class="token-number">0</span>]      <span class="token-comment">// "Jan" (first)</span>
<span class="token-function">println</span> periods[<span class="token-number">-1</span>]     <span class="token-comment">// "Jun" (last)</span>

<span class="token-comment">// Powerful filtering</span>
<span class="token-keyword">def</span> q1Periods = periods.<span class="token-function">findAll</span> { it <span class="token-keyword">in</span> [<span class="token-string">"Jan"</span>, <span class="token-string">"Feb"</span>, <span class="token-string">"Mar"</span>] }</code></pre>
                    </div>
                    <h4>Maps for POV Contexts and Lookups</h4>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <pre data-language="groovy"><code><span class="token-comment">// Store POV selections</span>
<span class="token-keyword">def</span> pov = [
    <span class="token-property">Year</span>: <span class="token-string">"FY24"</span>,
    <span class="token-property">Period</span>: <span class="token-string">"Jan"</span>,
    <span class="token-property">Scenario</span>: <span class="token-string">"Actual"</span>,
    <span class="token-property">Entity</span>: <span class="token-string">"E100"</span>
]

<span class="token-comment">// Tax rate lookup table</span>
<span class="token-keyword">def</span> taxRates = [<span class="token-string">"US"</span>: <span class="token-number">0.21</span>, <span class="token-string">"UK"</span>: <span class="token-number">0.19</span>, <span class="token-string">"DE"</span>: <span class="token-number">0.30</span>]
<span class="token-keyword">def</span> taxRate = taxRates[region] <span class="token-operator">?:</span> <span class="token-number">0.25</span>  <span class="token-comment">// Default 25%</span></code></pre>
                    </div>
                </section>
                <!-- Part 2: EPM Environment -->
                <section class="section" id="architecture">
                    <h2>Part 2: EPM Groovy Environment and Architecture</h2>
                    <p>Understanding where and how Groovy scripts execute is essential before writing production rules.</p>
                    <div class="diagram">
                        <div class="diagram-title">EPM Groovy Execution Architecture</div>
<pre>User Action (Form Save, Rule Launch, Job Scheduler)
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              CALCULATION MANAGER                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              GROOVY SCRIPT EXECUTION               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚           EPM OBJECT MODEL                   â”‚  â”‚
â”‚  â”‚  operation â”‚ application â”‚ cube â”‚ grid      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                        â”‚
        â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ESSBASE CUBE    â”‚   â”‚    EXTERNAL SYSTEMS        â”‚
â”‚ (if String return)â”‚   â”‚  REST APIs â”‚ Data Mgmt    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</pre>
                    </div>
                </section>

                <section class="section" id="script-types">
                    <h3>Script Types and When to Use Them</h3>
                    <h4>Type 1: Dynamic Calc Script Generators</h4>
                    <p>Return strings that become Essbase calculations:</p>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <pre data-language="groovy"><code><span class="token-comment">// Returns a calc script targeting only edited cells</span>
<span class="token-keyword">def</span> editedPeriods = [] <span class="token-keyword">as</span> <span class="token-class">Set</span>
operation.grid.<span class="token-function">dataCellIterator</span>({ it.edited }).<span class="token-function">each</span> { cell ->
    editedPeriods << cell.periodName
}

<span class="token-keyword">return</span> <span class="token-string">"""
FIX(${editedPeriods.collect { "\"$it\"" }.join(',')})
    "Revenue" = "Units" * "Price";
ENDFIX
"""</span></code></pre>
                    </div>
                    <h4>Type 2: Pure Groovy Rules</h4>
                    <p>Perform operations without generating calc scripts:</p>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <pre data-language="groovy"><code><span class="token-comment">// Data validation - no calc script generated</span>
operation.grid.<span class="token-function">dataCellIterator</span>().<span class="token-function">each</span> { cell ->
    <span class="token-keyword">if</span> (cell.edited && cell.data < <span class="token-number">0</span>) {
        cell.<span class="token-function">addValidationError</span>(<span class="token-number">0xFF0000</span>, <span class="token-string">"Negative values not allowed"</span>)
    }
}
<span class="token-comment">// Returns nothing - no Essbase calc executed</span></code></pre>
                    </div>
                </section>

                <section class="section" id="creating-rules">
                    <h3>Creating Your First Groovy Business Rule</h3>
                    <ol>
                        <li>Navigate to <strong>Home â†’ Create and Manage â†’ Rules</strong></li>
                        <li>Select <strong>Actions â†’ New Object</strong></li>
                        <li>Choose Application Type, Application, and Cube</li>
                        <li>Set Object Type = Rule, enter name, click OK</li>
                        <li>In Designer dropdown, select <strong>"Edit Script"</strong></li>
                        <li>In Script Type dropdown, select <strong>"Groovy Script"</strong></li>
                        <li>Click Save, then <strong>"Validate and Deploy"</strong></li>
                    </ol>
                    <div class="callout callout-warning">
                        <div class="callout-title">âš ï¸ Licensing Requirements</div>
                        Groovy is available with Enterprise Performance Management Enterprise Cloud Service, Enterprise PBCS (ePBCS), or PBCS Plus One. Groovy is <strong>NOT</strong> available in Standard PBCS standalone.
                    </div>
                </section>

                <!-- Part 3: Planning -->
                <section class="section" id="planning-overview">
                    <h2>Part 3: EPM Planning (EPBCS) Groovy Scripting</h2>
                    <p>Planning is where Groovy scripting shines brightest, offering extensive APIs for data manipulation, validation, and automation.</p>
                    <div class="card-grid">
                        <div class="card"><div class="card-icon">ğŸ“Š</div><div class="card-title">DataGridDefinitionBuilder</div><div class="card-description">Define and retrieve data slices from cubes.</div></div>
                        <div class="card"><div class="card-icon">âœï¸</div><div class="card-title">DataGridBuilder</div><div class="card-description">Write data programmatically to cubes.</div></div>
                        <div class="card"><div class="card-icon">ğŸ”„</div><div class="card-title">Form Grid Access</div><div class="card-description">Direct manipulation of form data during interactions.</div></div>
                        <div class="card"><div class="card-icon">âœ…</div><div class="card-title">Validations</div><div class="card-description">Custom data quality rules with visual feedback.</div></div>
                    </div>
                </section>

                <section class="section" id="datagrid-definition">
                    <h3>DataGridDefinitionBuilder for Reading Data</h3>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <pre data-language="groovy"><code><span class="token-comment">// Get the cube reference</span>
<span class="token-class">Cube</span> cube = operation.application.<span class="token-function">getCube</span>(<span class="token-string">"Plan1"</span>)

<span class="token-comment">// Create the builder</span>
<span class="token-class">DataGridDefinitionBuilder</span> builder = cube.<span class="token-function">dataGridDefinitionBuilder</span>()

<span class="token-comment">// Set POV dimensions and members</span>
builder.<span class="token-function">setPov</span>([<span class="token-string">'Years'</span>, <span class="token-string">'Scenario'</span>, <span class="token-string">'Currency'</span>, <span class="token-string">'Period'</span>, <span class="token-string">'Version'</span>, <span class="token-string">'Entity'</span>], 
               [[<span class="token-string">'FY24'</span>], [<span class="token-string">'Actual'</span>], [<span class="token-string">'USD'</span>], [<span class="token-string">'Jan'</span>], [<span class="token-string">'Working'</span>], [<span class="token-string">'USA'</span>]])

<span class="token-comment">// Define columns</span>
builder.<span class="token-function">addColumn</span>([<span class="token-string">'Account'</span>], [[<span class="token-string">'Revenue'</span>, <span class="token-string">'Expenses'</span>, <span class="token-string">'Net_Income'</span>]])

<span class="token-comment">// Define rows - supports member functions</span>
builder.<span class="token-function">setRow</span>([<span class="token-string">'Product'</span>], [[<span class="token-string">'ILvl0Descendants("All_Products")'</span>]])

<span class="token-comment">// Build and load</span>
cube.<span class="token-function">loadGrid</span>(builder.<span class="token-function">build</span>(), <span class="token-boolean">false</span>).<span class="token-function">withCloseable</span> { grid ->
    grid.<span class="token-function">dataCellIterator</span>().<span class="token-function">each</span> { cell ->
        <span class="token-function">println</span>(<span class="token-string">"${cell.memberNames}, data: ${cell.data}"</span>)
    }
}</code></pre>
                    </div>
                </section>

                <section class="section" id="datagrid-builder">
                    <h3>DataGridBuilder for Writing Data</h3>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <pre data-language="groovy"><code><span class="token-class">Cube</span> cube = operation.application.<span class="token-function">getCube</span>(<span class="token-string">"Plan1"</span>)
<span class="token-class">DataGridBuilder</span> builder = cube.<span class="token-function">dataGridBuilder</span>(<span class="token-string">"MM/DD/YYYY"</span>)

<span class="token-comment">// POV - list members without dimension names</span>
builder.<span class="token-function">addPov</span>(<span class="token-string">'Actual'</span>, <span class="token-string">'USD'</span>, <span class="token-string">'Working'</span>)

<span class="token-comment">// Columns - call once per dimension</span>
builder.<span class="token-function">addColumn</span>(<span class="token-string">'FY24'</span>, <span class="token-string">'FY24'</span>, <span class="token-string">'FY24'</span>)
builder.<span class="token-function">addColumn</span>(<span class="token-string">'Jan'</span>, <span class="token-string">'Feb'</span>, <span class="token-string">'Mar'</span>)

<span class="token-comment">// Rows with data</span>
builder.<span class="token-function">addRow</span>([<span class="token-string">'USA'</span>, <span class="token-string">'Revenue'</span>], [<span class="token-number">100000</span>, <span class="token-number">110000</span>, <span class="token-number">120000</span>])
builder.<span class="token-function">addRow</span>([<span class="token-string">'USA'</span>, <span class="token-string">'Expenses'</span>], [<span class="token-number">80000</span>, <span class="token-number">85000</span>, <span class="token-number">90000</span>])

<span class="token-comment">// Build and save</span>
<span class="token-class">DataGridBuilder.Status</span> status = <span class="token-keyword">new</span> <span class="token-class">DataGridBuilder.Status</span>()
builder.<span class="token-function">build</span>(status).<span class="token-function">withCloseable</span> { grid ->
    <span class="token-function">println</span>(<span class="token-string">"Cells accepted: $status.numAcceptedCells"</span>)
    cube.<span class="token-function">saveGrid</span>(grid)
}</code></pre>
                    </div>
                </section>

                <section class="section" id="form-grid">
                    <h3>Working with Form Grid Cells</h3>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <pre data-language="groovy"><code><span class="token-comment">// Iterate all cells</span>
operation.grid.<span class="token-function">dataCellIterator</span>().<span class="token-function">each</span> { cell ->
    <span class="token-function">println</span>(<span class="token-string">"${cell.memberNames}: ${cell.data}"</span>)
}

<span class="token-comment">// Key cell properties</span>
cell.data                    <span class="token-comment">// Numeric value</span>
cell.formattedValue          <span class="token-comment">// Formatted string</span>
cell.memberNames             <span class="token-comment">// List of all dimension members</span>
cell.<span class="token-function">getMemberName</span>(<span class="token-string">'Account'</span>) <span class="token-comment">// Specific dimension member</span>
cell.<span class="token-function">isEdited</span>()              <span class="token-comment">// True if modified</span>
cell.<span class="token-function">isMissing</span>()             <span class="token-comment">// True if #MISSING</span>

<span class="token-comment">// Modify cells</span>
cell.<span class="token-function">setData</span>(<span class="token-number">12345.67</span>)
cell.<span class="token-function">setBgColor</span>(<span class="token-number">0xFF0000</span>)    <span class="token-comment">// Red background</span>
cell.<span class="token-function">setTooltip</span>(<span class="token-string">"Custom message"</span>)

<span class="token-comment">// Cross-dimensional access</span>
<span class="token-class">DataCell</span> bonusCell = cell.<span class="token-function">crossDimCell</span>(<span class="token-string">'Bonus'</span>, <span class="token-string">'Jan'</span>)</code></pre>
                    </div>
                </section>

                <section class="section" id="validations">
                    <h3>Custom Validations and Data Quality Rules</h3>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <pre data-language="groovy"><code><span class="token-comment">// Validate form data against ranges</span>
operation.grid.<span class="token-function">dataCellIterator</span>(<span class="token-string">'Salary'</span>).<span class="token-function">each</span> { cell ->
    <span class="token-keyword">def</span> grade = cell.<span class="token-function">crossDimCell</span>(<span class="token-string">'Grade'</span>).dataAsSmartListMemberName
    <span class="token-keyword">def</span> minSalary = gradeRanges[grade]?.min <span class="token-operator">?:</span> <span class="token-number">0</span>
    <span class="token-keyword">def</span> maxSalary = gradeRanges[grade]?.max <span class="token-operator">?:</span> <span class="token-number">999999</span>
    
    <span class="token-keyword">if</span> (cell.data < minSalary || cell.data > maxSalary) {
        cell.<span class="token-function">addValidationError</span>(<span class="token-number">0xFF0000</span>, <span class="token-string">"Salary outside range for grade"</span>)
    }
}

<span class="token-comment">// Block save with message</span>
<span class="token-function">throwVetoException</span>(<span class="token-string">"Error message to user"</span>)</code></pre>
                    </div>
                    <div class="diagram">
                        <div class="diagram-title">Before/After: Dynamic Calculation Impact</div>
<pre>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BEFORE: Traditional Calc Script                    â”‚
â”‚  FIX(@RELATIVE("All_Products", 0))                 â”‚
â”‚      "Revenue" = "Units" * "Price";                â”‚
â”‚  ENDFIX                                            â”‚
â”‚  â†’ Calculates 5,000 products Ã— 12 periods          â”‚
â”‚  â†’ Runtime: 45 seconds                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER: Groovy Dynamic Targeting                   â”‚
â”‚  FIX("Product_A", "Product_B", "Jan", "Feb")       â”‚
â”‚      "Revenue" = "Units" * "Price";                â”‚
â”‚  ENDFIX                                            â”‚
â”‚  â†’ Calculates ONLY 2 products Ã— 2 periods          â”‚
â”‚  â†’ Runtime: <1 second                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</pre>
                    </div>
                </section>
                <!-- Part 4: FCCS -->
                <section class="section" id="fccs-overview">
                    <h2>Part 4: FCCS Groovy Scripting â€” Consolidation and Close</h2>
                    <p>Financial Consolidation and Close uses Groovy differently than Planning. FCCS relies primarily on seeded Essbase calc scripts for consolidation logic, with Groovy serving as an automation and orchestration layer.</p>
                    <div class="table-wrapper">
                        <table>
                            <thead><tr><th>Tab</th><th>Insertion Point</th><th>Use Case</th></tr></thead>
                            <tbody>
                                <tr><td>Local Currency</td><td>After Opening Balance</td><td>Adjust opening balances</td></tr>
                                <tr><td>Local Currency</td><td>Final Calculations</td><td>Custom local currency calcs</td></tr>
                                <tr><td>Translated</td><td>After Opening Balance</td><td>Translation adjustments</td></tr>
                                <tr><td>Consolidated</td><td>After Eliminations</td><td>Custom elimination entries</td></tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section class="section" id="consolidation">
                    <h3>Executing Consolidation Rules via Groovy</h3>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <pre data-language="groovy"><code><span class="token-comment">/*RTPS: {Scenario} {Years} {Period} {Entity}*/</span>

<span class="token-class">HttpResponse</span><<span class="token-class">String</span>> response = operation.application
    .<span class="token-function">getConnection</span>(<span class="token-string">"FCCS_Connection"</span>)
    .<span class="token-function">post</span>(<span class="token-string">"/rest/v3/applications/FCCSApp/jobs"</span>)
    .<span class="token-function">header</span>(<span class="token-string">"Content-Type"</span>, <span class="token-string">"application/json"</span>)
    .<span class="token-function">body</span>(<span class="token-function">json</span>([
        <span class="token-string">"jobType"</span> : <span class="token-string">"Rules"</span>, 
        <span class="token-string">"jobName"</span> : <span class="token-string">"Translate"</span>,
        <span class="token-string">"parameters"</span>: [
            <span class="token-string">"Currency"</span>: <span class="token-string">"USD_Reporting"</span>,
            <span class="token-string">"Scenario"</span>: rtps.Scenario.<span class="token-function">toString</span>(),
            <span class="token-string">"Entity"</span>: rtps.Entity.<span class="token-function">toString</span>()
        ]
    ])).<span class="token-function">asString</span>()</code></pre>
                    </div>
                </section>

                <section class="section" id="journals">
                    <h3>Journal Entry Validation</h3>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <pre data-language="groovy"><code><span class="token-keyword">def</span> totalDebits = <span class="token-number">0.0</span>
<span class="token-keyword">def</span> totalCredits = <span class="token-number">0.0</span>

operation.grid.<span class="token-function">dataCellIterator</span>().<span class="token-function">each</span> { cell ->
    <span class="token-keyword">def</span> accountName = cell.<span class="token-function">getMemberName</span>(<span class="token-string">"Account"</span>)
    
    <span class="token-keyword">if</span>(accountName.<span class="token-function">contains</span>(<span class="token-string">"Debit"</span>)) {
        totalDebits += cell.data <span class="token-operator">?:</span> <span class="token-number">0</span>
    } <span class="token-keyword">else if</span>(accountName.<span class="token-function">contains</span>(<span class="token-string">"Credit"</span>)) {
        totalCredits += cell.data <span class="token-operator">?:</span> <span class="token-number">0</span>
    }
}

<span class="token-keyword">def</span> difference = <span class="token-class">Math</span>.<span class="token-function">abs</span>(totalDebits - totalCredits)
<span class="token-keyword">if</span>(difference > <span class="token-number">0.01</span>) {
    <span class="token-function">throwVetoException</span>(<span class="token-string">"Journal must balance. Difference: ${difference}"</span>)
}</code></pre>
                    </div>
                </section>

                <section class="section" id="close-process">
                    <h3>Automated Close Process Pipeline</h3>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <pre data-language="groovy"><code><span class="token-keyword">def</span> <span class="token-function">runCloseProcess</span>(scenario, year, period, entity) {
    <span class="token-keyword">def</span> conn = operation.application.<span class="token-function">getConnection</span>(<span class="token-string">"FCCS_Connection"</span>)
    <span class="token-keyword">def</span> baseUrl = <span class="token-string">"/rest/v3/applications/FCCSApp/jobs"</span>
    
    <span class="token-comment">// Step 1: Force Translate</span>
    <span class="token-function">println</span> <span class="token-string">"Step 1: Running Translation..."</span>
    conn.<span class="token-function">post</span>(baseUrl).<span class="token-function">body</span>(<span class="token-function">json</span>([
        <span class="token-string">"jobType"</span>: <span class="token-string">"Rules"</span>,
        <span class="token-string">"jobName"</span>: <span class="token-string">"ForceTranslate"</span>,
        <span class="token-string">"parameters"</span>: [<span class="token-string">"Scenario"</span>: scenario, <span class="token-string">"Year"</span>: year, <span class="token-string">"Period"</span>: period]
    ])).<span class="token-function">asString</span>()
    
    <span class="token-comment">// Step 2: Force Consolidate</span>
    <span class="token-function">println</span> <span class="token-string">"Step 2: Running Consolidation..."</span>
    conn.<span class="token-function">post</span>(baseUrl).<span class="token-function">body</span>(<span class="token-function">json</span>([
        <span class="token-string">"jobType"</span>: <span class="token-string">"Rules"</span>,
        <span class="token-string">"jobName"</span>: <span class="token-string">"ForceConsolidate"</span>,
        <span class="token-string">"parameters"</span>: [<span class="token-string">"Scenario"</span>: scenario, <span class="token-string">"Entity"</span>: entity]
    ])).<span class="token-function">asString</span>()
    
    <span class="token-function">println</span> <span class="token-string">"Close process completed"</span>
}</code></pre>
                    </div>
                </section>

                <!-- Part 5: PCMCS -->
                <section class="section" id="pcmcs-overview">
                    <h2>Part 5: PCMCS (Profitability and Cost Management)</h2>
                    <p>PCMCS has a fundamentally different architectureâ€”it's built on an ASO (Aggregate Storage) cube with an allocation-centric rule engine.</p>
                    <div class="table-wrapper">
                        <table>
                            <thead><tr><th>Feature</th><th>Planning / FCCS</th><th>PCMCS</th></tr></thead>
                            <tbody>
                                <tr><td>Cube Type</td><td>BSO (Block Storage)</td><td>ASO (Aggregate Storage)</td></tr>
                                <tr><td>Primary Rules</td><td>Calc scripts, Groovy</td><td>Allocation rules, MDX</td></tr>
                                <tr><td>Groovy Role</td><td>Direct calculation</td><td>Orchestration</td></tr>
                                <tr><td>Job Scheduler</td><td>Native</td><td>None (use Planning)</td></tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section class="section" id="pcmcs-jobs">
                    <h3>Triggering PCMCS Jobs from Groovy</h3>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <pre data-language="groovy"><code><span class="token-comment">// Execute PCMCS allocation calculations from Planning</span>
<span class="token-class">HttpResponse</span> response = operation.application
    .<span class="token-function">getConnection</span>(<span class="token-string">"EPCM_Connection"</span>)
    .<span class="token-function">post</span>()
    .<span class="token-function">header</span>(<span class="token-string">"Content-Type"</span>, <span class="token-string">"application/json"</span>)
    .<span class="token-function">body</span>(<span class="token-function">json</span>([
        <span class="token-string">"jobType"</span>: <span class="token-string">"CALCULATION"</span>,
        <span class="token-string">"jobName"</span>: <span class="token-string">"RunAllAllocations"</span>,
        <span class="token-string">"povGroupMember"</span>: <span class="token-string">"2024_January_Actual"</span>
    ])).<span class="token-function">asString</span>()

<span class="token-keyword">if</span>(response.status == <span class="token-number">200</span>) {
    <span class="token-function">println</span> <span class="token-string">"Calculation initiated successfully"</span>
}</code></pre>
                    </div>
                </section>

                <!-- Part 6: Advanced -->
                <section class="section" id="rest-api">
                    <h2>Part 6: Advanced Topics</h2>
                    <h3>REST API Integration from Groovy</h3>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <pre data-language="groovy"><code><span class="token-comment">// Named connections - secure and encrypted</span>
<span class="token-class">Connection</span> connection = operation.application.<span class="token-function">getConnection</span>(<span class="token-string">"ExternalAPI"</span>)

<span class="token-comment">// HTTP methods</span>
<span class="token-class">HttpResponse</span><<span class="token-class">String</span>> getResponse = connection.<span class="token-function">get</span>(<span class="token-string">"/endpoint"</span>).<span class="token-function">asString</span>()

<span class="token-class">HttpResponse</span><<span class="token-class">String</span>> postResponse = connection.<span class="token-function">post</span>()
    .<span class="token-function">header</span>(<span class="token-string">"Content-Type"</span>, <span class="token-string">"application/json"</span>)
    .<span class="token-function">body</span>(<span class="token-function">json</span>([<span class="token-string">"key"</span>: <span class="token-string">"value"</span>]))
    .<span class="token-function">asString</span>()</code></pre>
                    </div>
                    <div class="callout callout-warning">
                        <div class="callout-title">âš ï¸ Security Requirements</div>
                        <ul>
                            <li>Only HTTPS allowed (no HTTP)</li>
                            <li>Port 443 only</li>
                            <li>Valid SSL certificates required</li>
                            <li><strong>Never use on-demand connections in production</strong></li>
                        </ul>
                    </div>
                </section>

                <section class="section" id="epm-automate">
                    <h3>EPM Automate from Groovy</h3>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <pre data-language="groovy"><code><span class="token-comment">// Get EPM Automate instance - runs server-side</span>
<span class="token-class">EpmAutomate</span> automate = <span class="token-function">getEpmAutomate</span>()

<span class="token-comment">// Login</span>
<span class="token-class">EpmAutomateStatus</span> status = automate.<span class="token-function">execute</span>(<span class="token-string">"login"</span>, 
    <span class="token-string">"username"</span>, <span class="token-string">"password.epw"</span>, <span class="token-string">"https://env-url.oraclecloud.com"</span>)

<span class="token-keyword">if</span> (status.<span class="token-function">getStatus</span>() != <span class="token-number">0</span>) {
    <span class="token-function">throwVetoException</span>(<span class="token-string">"Login failed: ${status.getOutput()}"</span>)
}

<span class="token-comment">// Run integration</span>
status = automate.<span class="token-function">execute</span>(<span class="token-string">"runIntegration"</span>, <span class="token-string">"MyIntegration"</span>, 
    <span class="token-string">"importMode=Replace"</span>, <span class="token-string">"exportMode=Merge"</span>)

<span class="token-comment">// Export snapshot</span>
automate.<span class="token-function">execute</span>(<span class="token-string">"exportsnapshot"</span>, <span class="token-string">"MonthEnd_Snapshot"</span>)

automate.<span class="token-function">execute</span>(<span class="token-string">"logout"</span>)</code></pre>
                    </div>
                </section>

                <section class="section" id="performance">
                    <h3>Performance Optimization Techniques</h3>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <pre data-language="groovy"><code><span class="token-comment">// Target only edited cells instead of entire database</span>
<span class="token-keyword">def</span> editedMembers = [] <span class="token-keyword">as</span> <span class="token-class">Set</span>
operation.grid.<span class="token-function">dataCellIterator</span>({ it.edited }).<span class="token-function">each</span> { cell ->
    editedMembers << cell.periodName
    editedMembers << cell.<span class="token-function">getMemberName</span>(<span class="token-string">"Product"</span>)
}

<span class="token-comment">// Chunking large operations</span>
<span class="token-keyword">def</span> allMembers = app.<span class="token-function">getDimension</span>(<span class="token-string">"Entity"</span>)
    .<span class="token-function">getEvaluatedMembers</span>(<span class="token-string">"ILvl0Descendants(AllEntities)"</span>, cube)

allMembers.<span class="token-function">collate</span>(<span class="token-number">50</span>).<span class="token-function">each</span> { memberChunk ->
    <span class="token-keyword">def</span> memberList = memberChunk.<span class="token-function">collect</span> { <span class="token-function">fixValues</span>(it) }.<span class="token-function">join</span>(<span class="token-string">', '</span>)
    cube.<span class="token-function">executeCalcScript</span>(<span class="token-string">"FIX($memberList) ... ENDFIX"</span>)
}</code></pre>
                    </div>
                </section>
                <!-- Part 7: Updates -->
                <section class="section" id="updates-2025">
                    <h2>Part 7: 2024-2025 Platform Updates</h2>
                    <div class="callout callout-success">
                        <div class="callout-title">âœ… June 2025 Updates</div>
                        <ul>
                            <li><strong>ZIP File Creation</strong> from Groovy scripts</li>
                            <li><strong>Excel File Creation</strong> with new <code>Workbook</code> class</li>
                        </ul>
                    </div>
                    <div class="callout callout-success">
                        <div class="callout-title">âœ… August-September 2025 Updates</div>
                        <ul>
                            <li><strong>Groovy Script Validator</strong> tool for pre-upgrade compatibility checking</li>
                            <li><strong>Pipeline SFTP Support</strong> with new Copy to/from SFTP job types</li>
                            <li><strong>Secure Parameters</strong> in connections are no longer exported/imported</li>
                        </ul>
                    </div>
                </section>

                <section class="section" id="groovy-upgrade">
                    <h3>Critical: Groovy Engine Upgrade (January 2026)</h3>
                    <div class="callout callout-error">
                        <div class="callout-title">âš ï¸ Action Required Before January 2026</div>
                        <p><strong>Stricter Validation Rules</strong> coming with the 26.01 update:</p>
                        <ul>
                            <li><strong>Groovy Script Validator</strong> available since August 2025</li>
                            <li><strong>Grace Period</strong> via EPM Automate <code>skipUpdate</code> (up to 3 months)</li>
                            <li><strong>Security Requirement</strong> makes this upgrade mandatory</li>
                        </ul>
                    </div>
                    <h4>Migration Checklist</h4>
                    <ol>
                        <li>Run the Groovy Script Validator on all existing scripts</li>
                        <li>Review for deprecated methods and dynamic typing issues</li>
                        <li>Test thoroughly in development environment</li>
                        <li>Update on-demand connections to named connections</li>
                        <li>Verify all scripts before January 2026</li>
                    </ol>
                </section>

                <!-- Diagrams -->
                <section class="section" id="diagrams">
                    <h2>Visual Diagrams and Decision Frameworks</h2>
                    <div class="diagram">
                        <div class="diagram-title">Decision Tree: Choosing Script Approach</div>
<pre>START: What do I need to accomplish?
â”‚
â”œâ”€â–º Data Validation?
â”‚   â””â”€â–º Use Pure Groovy Rule (Before Save)
â”‚       â€¢ throwVetoException() to block
â”‚       â€¢ cell.addValidationError() for warnings
â”‚
â”œâ”€â–º Calculate Only Edited Data?
â”‚   â””â”€â–º Use Dynamic Calc Script Generator
â”‚       â€¢ Iterate grid to find edited cells
â”‚       â€¢ Return FIX statement targeting those members
â”‚
â”œâ”€â–º Complex Member Iteration?
â”‚   â””â”€â–º Use DataGridDefinitionBuilder
â”‚       â€¢ Read data into memory
â”‚       â€¢ Process with Groovy logic
â”‚
â”œâ”€â–º External System Integration?
â”‚   â””â”€â–º Use REST API Connections
â”‚       â€¢ Named connections for security
â”‚       â€¢ Poll for job completion
â”‚
â””â”€â–º Simple Calculation?
    â””â”€â–º Consider Traditional Calc Script
        â€¢ Groovy adds overhead
        â€¢ Use Groovy only when it adds value</pre>
                    </div>
                    <div class="diagram">
                        <div class="diagram-title">Form Save Data Flow</div>
<pre>Form Save Triggered
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BEFORE SAVE (Groovy Rule)      â”‚
â”‚  1. Iterate edited cells        â”‚
â”‚  2. Validate data quality       â”‚
â”‚  3. throwVetoException if bad   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚ (if validation passes)
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DATA SAVED TO BSO CUBE         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER SAVE (Groovy Rule)       â”‚
â”‚  1. Collect edited members      â”‚
â”‚  2. Execute focused calc script â”‚
â”‚  3. Run targeted Smart Push     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ASO REPORTING CUBE UPDATED     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</pre>
                    </div>
                </section>

                <!-- Quick Reference -->
                <section class="section" id="quick-reference">
                    <h2>Quick Reference: Essential Code Patterns</h2>
                    <h3>Reading Data</h3>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <pre data-language="groovy"><code><span class="token-comment">// From current form</span>
operation.grid.<span class="token-function">dataCellIterator</span>().<span class="token-function">each</span> { cell -> <span class="token-comment">/* process */</span> }

<span class="token-comment">// From any cube slice</span>
<span class="token-class">DataGridDefinitionBuilder</span> builder = cube.<span class="token-function">dataGridDefinitionBuilder</span>()
builder.<span class="token-function">setPov</span>([...], [[...]])
builder.<span class="token-function">addColumn</span>([...], [[...]])
builder.<span class="token-function">addRow</span>([...], [[...]])
cube.<span class="token-function">loadGrid</span>(builder.<span class="token-function">build</span>(), <span class="token-boolean">false</span>).<span class="token-function">withCloseable</span> { grid ->
    grid.<span class="token-function">dataCellIterator</span>().<span class="token-function">each</span> { cell -> <span class="token-comment">/* process */</span> }
}</code></pre>
                    </div>
                    <h3>Writing Data</h3>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <pre data-language="groovy"><code><span class="token-class">DataGridBuilder</span> builder = cube.<span class="token-function">dataGridBuilder</span>(<span class="token-string">"MM/DD/YYYY"</span>)
builder.<span class="token-function">addPov</span>(member1, member2, ...)
builder.<span class="token-function">addColumn</span>(col1, col2, ...)
builder.<span class="token-function">addRow</span>([rowHeaders], [dataValues])
builder.<span class="token-function">build</span>().<span class="token-function">withCloseable</span> { grid -> cube.<span class="token-function">saveGrid</span>(grid) }</code></pre>
                    </div>
                    <h3>Validation and Blocking</h3>
                    <div class="code-wrapper">
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                        <pre data-language="groovy"><code><span class="token-comment">// Block save with message</span>
<span class="token-function">throwVetoException</span>(<span class="token-string">"Error message to user"</span>)

<span class="token-comment">// Cell-level error (doesn't block)</span>
cell.<span class="token-function">addValidationError</span>(<span class="token-number">0xFF0000</span>, <span class="token-string">"Error message"</span>)

<span class="token-comment">// Cell-level warning</span>
cell.<span class="token-function">addValidationWarning</span>(<span class="token-string">"Warning message"</span>)</code></pre>
                    </div>
                </section>

                <!-- Resources -->
                <section class="section" id="resources">
                    <h2>External Resources</h2>
                    <div class="card-grid">
                        <a href="https://docs.oracle.com/en/cloud/saas/enterprise-performance-management-common/groov/index.html" target="_blank" class="card" style="text-decoration: none;">
                            <div class="card-icon">ğŸ“š</div>
                            <div class="card-title">Official Groovy API Reference</div>
                            <div class="card-description">Oracle's complete API documentation for EPM Groovy scripting.</div>
                        </a>
                        <a href="https://docs.oracle.com/en/cloud/saas/enterprise-performance-management-common/groovy-tutorial-introduction/index.html" target="_blank" class="card" style="text-decoration: none;">
                            <div class="card-icon">ğŸ“</div>
                            <div class="card-title">Oracle Groovy Tutorial</div>
                            <div class="card-description">Official introduction to Groovy Business Rules.</div>
                        </a>
                        <a href="https://theepmlab.com/category/groovy/" target="_blank" class="card" style="text-decoration: none;">
                            <div class="card-icon">ğŸ§ª</div>
                            <div class="card-title">The EPM Lab - Groovy</div>
                            <div class="card-description">Community tutorials and practical examples.</div>
                        </a>
                        <a href="https://in2hyperion.com/tag/groovy/" target="_blank" class="card" style="text-decoration: none;">
                            <div class="card-icon">ğŸ’¡</div>
                            <div class="card-title">in2Hyperion</div>
                            <div class="card-description">Kyle Goodfriend's Groovy calculations tips.</div>
                        </a>
                    </div>
                </section>

                <footer class="footer">
                    <p>Oracle EPM Cloud Groovy Scripting Study Guide â€¢ Version 2.1 â€¢ December 2025</p>
                    <p>This guide is for educational purposes. Always test scripts in a development environment first.</p>
                </footer>
            </div>
        </main>
    </div>

    <button class="back-to-top" id="backToTop" onclick="scrollToTop()" aria-label="Back to top">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="18 15 12 9 6 15"></polyline></svg>
    </button>

    <script>
        function toggleTheme() {
            const html = document.documentElement;
            const newTheme = html.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        }
        const savedTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-theme', savedTheme);
        
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
            document.getElementById('overlay').classList.toggle('show');
        }
        
        window.addEventListener('scroll', () => {
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            document.getElementById('progressFill').style.width = (winScroll / height) * 100 + '%';
            document.getElementById('backToTop').classList.toggle('visible', winScroll > 300);
        });
        
        function scrollToTop() { window.scrollTo({ top: 0, behavior: 'smooth' }); }
        
        const sections = document.querySelectorAll('.section');
        const navLinks = document.querySelectorAll('.nav-link');
        window.addEventListener('scroll', () => {
            let current = '';
            sections.forEach(section => {
                if (scrollY >= section.offsetTop - 200) current = section.getAttribute('id');
            });
            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === '#' + current) link.classList.add('active');
            });
        });
        
        function copyCode(button) {
            const code = button.parentElement.querySelector('pre code').innerText;
            navigator.clipboard.writeText(code).then(() => {
                button.textContent = 'Copied!';
                button.classList.add('copied');
                setTimeout(() => { button.textContent = 'Copy'; button.classList.remove('copied'); }, 2000);
            });
        }
        
        function searchContent() {
            const query = document.getElementById('searchInput').value.toLowerCase();
            if (query.length < 2) { document.querySelectorAll('.section').forEach(s => s.style.display = 'block'); return; }
            document.querySelectorAll('.section').forEach(section => {
                section.style.display = section.textContent.toLowerCase().includes(query) ? 'block' : 'none';
            });
        }
        
        navLinks.forEach(link => link.addEventListener('click', () => { if (window.innerWidth <= 1024) toggleSidebar(); }));
    </script>
</body>
</html>
